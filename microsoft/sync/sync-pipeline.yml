# Copyright (c) Microsoft Corporation.
# Use of this source code is governed by a BSD-style
# license that can be found in the LICENSE file.

trigger: none
pr: none

variables:
  - group: Microsoft-GoLang-bot

jobs:
  - job: Sync
    pool:
      vmImage: ubuntu-20.04
    workspace:
      clean: all
    steps:
      - template: /microsoft/pipeline/checkout-unix-task.yml

      - script: |
          set -ex
          git config --global user.name 'microsoft-golang-bot'
          git config --global user.email 'microsoft-golang-bot@users.noreply.github.com'

          . microsoft/init-stage0.sh
          "$stage0_dir/go/bin/go" run microsoft/sync/sync-upstream-refs.go \
            -origin https://microsoft-golang-bot:$(BotAccount-microsoft-golang-bot-PAT)@github.com/microsoft/go \
            -to https://microsoft-golang-bot:$(BotAccount-microsoft-golang-bot-PAT)@github.com/microsoft-golang-bot/go \
            -github-pat $(BotAccount-microsoft-golang-bot-PAT) \
            -github-pat-reviewer $(BotAccount-microsoft-golang-review-bot-PAT) \
            -b master
        displayName: Sync
