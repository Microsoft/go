From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Quim Muntal <qmuntaldiaz@microsoft.com>
Date: Wed, 22 Jun 2022 12:16:05 +0000
Subject: [PATCH] Add BoringSSL crypto module

---
 .../internal/backend/bbig/big_boring.go       | 12 ++++
 src/crypto/internal/backend/boring_linux.go   | 59 +++++++++++++++++++
 2 files changed, 71 insertions(+)
 create mode 100644 src/crypto/internal/backend/bbig/big_boring.go
 create mode 100644 src/crypto/internal/backend/boring_linux.go

diff --git a/src/crypto/internal/backend/bbig/big_boring.go b/src/crypto/internal/backend/bbig/big_boring.go
new file mode 100644
index 00000000000000..0b62cef68546d0
--- /dev/null
+++ b/src/crypto/internal/backend/bbig/big_boring.go
@@ -0,0 +1,12 @@
+// Copyright 2022 The Go Authors. All rights reserved.
+// Use of this source code is governed by a BSD-style
+// license that can be found in the LICENSE file.
+
+//go:build goexperiment.boringcrypto
+
+package bbig
+
+import "crypto/internal/boring/bbig"
+
+var Enc = bbig.Enc
+var Dec = bbig.Dec
diff --git a/src/crypto/internal/backend/boring_linux.go b/src/crypto/internal/backend/boring_linux.go
new file mode 100644
index 00000000000000..22e3c42cba5c05
--- /dev/null
+++ b/src/crypto/internal/backend/boring_linux.go
@@ -0,0 +1,59 @@
+// Copyright 2017 The Go Authors. All rights reserved.
+// Use of this source code is governed by a BSD-style
+// license that can be found in the LICENSE file.
+
+//go:build goexperiment.boringcrypto && linux && cgo && amd64 && !android && !cmd_go_bootstrap && !msan
+
+// Package boring provides access to BoringCrypto implementation functions.
+// Check the variable Enabled to find out whether BoringCrypto is available.
+// If BoringCrypto is not available, the functions in this package all panic.
+package backend
+
+import "crypto/internal/boring"
+
+const Enabled = true
+
+const RandReader = boring.RandReader
+
+var NewSHA1 = boring.NewSHA1
+var NewSHA224 = boring.NewSHA224
+var NewSHA256 = boring.NewSHA256
+var NewSHA384 = boring.NewSHA384
+var NewSHA512 = boring.NewSHA512
+
+var SHA1 = boring.SHA1
+var SHA224 = boring.SHA224
+var SHA256 = boring.SHA256
+var SHA384 = boring.SHA384
+var SHA512 = boring.SHA512
+
+var NewHMAC = boring.NewHMAC
+
+var NewAESCipher = boring.NewAESCipher
+var NewGCMTLS = boring.NewGCMTLS
+
+type PublicKeyECDSA = boring.PublicKeyECDSA
+type PrivateKeyECDSA = boring.PrivateKeyECDSA
+
+var GenerateKeyECDSA = boring.GenerateKeyECDSA
+var NewPrivateKeyECDSA = boring.NewPrivateKeyECDSA
+var NewPublicKeyECDSA = boring.NewPublicKeyECDSA
+var SignMarshalECDSA = boring.SignMarshalECDSA
+var VerifyECDSA = boring.VerifyECDSA
+
+type PublicKeyRSA = boring.PublicKeyRSA
+type PrivateKeyRSA = boring.PrivateKeyRSA
+
+var DecryptRSAOAEP = boring.DecryptRSAOAEP
+var DecryptRSAPKCS1 = boring.DecryptRSAPKCS1
+var DecryptRSANoPadding = boring.DecryptRSANoPadding
+var EncryptRSAOAEP = boring.EncryptRSAOAEP
+var EncryptRSAPKCS1 = boring.EncryptRSAPKCS1
+var EncryptRSANoPadding = boring.EncryptRSANoPadding
+var GenerateKeyRSA = boring.GenerateKeyRSA
+var NewPrivateKeyRSA = boring.NewPrivateKeyRSA
+var NewPublicKeyRSA = boring.NewPublicKeyRSA
+var SignRSAPKCS1v15 = boring.SignRSAPKCS1v15
+var SignRSAPSS = boring.SignRSAPSS
+var VerifyRSAPKCS1v15 = boring.VerifyRSAPKCS1v15
+var VerifyRSAPSS = boring.VerifyRSAPSS
